import socket, platform, os


srvAddr = input("[+] Server IP address >")
srvPort = int(input("[+] Server port >"))

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.bind((srvAddr, srvPort))
sock.listen(1)

print("[+] Server started, waiting for connections")
conn, addr = sock.accept()
print("[+] Client connected. Client address is: ", addr)

while True:
    try:
        data = conn.recv(1024)
    except:continue
    if(data.decode('utf-8') == 1): # If the data received is equal to 1
        toSend = platform.platform() + " " + platform.machine()
        conn.sendall(toSend.encode())
    elif(data.decode('utf-8') == 2):
        data = conn.recv(1024)
        try:
            fileList = os.listdir(data.decode('utf-8'))
            toSend = ""
            for i in fileList:
                toSend += "," + i
        except:
            toSend = "[-] Wrong path!"
        conn.sendall(toSend.encode())
    elif(data.decode('utf-8') == 0):
        conn.close()
        conn, addr = sock.accept()
